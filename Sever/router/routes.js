const express = require("express");
const userModel = require("../models/models");
const ContactsModel = require("../models/contactsmodel");

const app = express();
app.post("/add_records", async (request, response) => {

  try {
    await userModel.insertMany(request.body);
    response.send(200);
  } catch (error) {
    response.status(500).send(error);
  }
});
app.post("/add_contacts", async (request, response) => {
  var currentdate = new Date();
  var datetime = "Last Sync: " + currentdate.getDate() + "/"
    + (currentdate.getMonth() + 1) + "/"
    + currentdate.getFullYear() + " @ "
    + currentdate.getHours() + ":"
    + currentdate.getMinutes() + ":"
    + currentdate.getSeconds();
  console.log('time', datetime);

  try {
    await ContactsModel.insertMany(request.body);
    response.send(200);
  } catch (error) {
    response.status(500).send(error);
  }


});

app.get("/users", async (request, response) => {
  const users = await userModel.find({});

  try {
    response.send(users);
  } catch (error) {
    response.status(500).send(error);
  }
});


module.exports = app;
